import java.io.*;
import java.net.HttpURLConnection;
import java.net.URL;
import java.nio.charset.StandardCharsets;

public class SoapClientRaw {

    public static void main(String[] args) throws Exception {
        // Your SOAP request XML as a String
        String soapRequest =
            """
            <?xml version="1.0" encoding="utf-8"?>
            <soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">
              <soap:Body>
                <CelsiusToFahrenheit xmlns="https://www.w3schools.com/xml/">
                  <Celsius>25</Celsius>
                </CelsiusToFahrenheit>
              </soap:Body>
            </soap:Envelope>
            """;

        // Endpoint URL (W3Schools temperature conversion demo service)
        URL url = new URL("https://www.w3schools.com/xml/tempconvert.asmx");
        HttpURLConnection conn = (HttpURLConnection) url.openConnection();

        conn.setRequestMethod("POST");
        conn.setRequestProperty("Content-Type", "text/xml; charset=utf-8");
        conn.setRequestProperty("SOAPAction", "https://www.w3schools.com/xml/CelsiusToFahrenheit");
        conn.setDoOutput(true);

        // Write SOAP request
        try (OutputStream os = conn.getOutputStream()) {
            byte[] input = soapRequest.getBytes(StandardCharsets.UTF_8);
            os.write(input);
        }

        // Read response
        int status = conn.getResponseCode();
        InputStream is = (status >= 200 && status < 300) ? conn.getInputStream() : conn.getErrorStream();

        try (BufferedReader br = new BufferedReader(new InputStreamReader(is))) {
            String line;
            System.out.println("=== SOAP Response ===");
            while ((line = br.readLine()) != null) {
                System.out.println(line);
            }
        }
    }
}
